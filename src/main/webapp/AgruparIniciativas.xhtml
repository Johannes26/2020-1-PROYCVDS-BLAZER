<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

  <h:head>

    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css" />

    <!-- Evento seguridad -->
    <f:event type="preRenderView" listener="#{principalBean.verificarSesion()}" />
    
  </h:head>
  <body background="fondo.jpg" onload="#{agruparBean.inicializar()}">
    
    
    
    
<script type="text/javascript">
    function handleDrop(event, ui) {
        var droppedCar = ui.draggable;
 
        droppedCar.fadeOut('fast');
    }
</script>
 
<h:form id="iniciativasForm" >
    <p:fieldset id="iniciativasR" legend="iniciativas Registradas">
        <p:dataGrid id="iniciativas" var="iniciativa" value="#{agruparBean.iniciativas}" columns="3">
            <p:panel id="pnl" header="#{iniciativa.num}" style="text-align:center">
                <h:outputText value="#{iniciativa.descripcion}" />
            </p:panel>
            <p:draggable for="pnl" revert="true" handle=".ui-panel-titlebar" stack=".ui-panel"/>
        </p:dataGrid>
    </p:fieldset>
 	<br/>
 	<br/>
 	<p:outputLabel value="Descripcion" style="color:#FFFFFF" />
 	<br/>
 	
 	<p:inputText id="descripcion" required="true" type="String" binding="#{descripcion}"/>
 	
    <p:fieldset id="SeleccionIniciativas" legend="Seleccion Iniciativas" style="margin-top:20px">
        <p:outputPanel id="dropArea">
            <h:outputText value="!!!Arrastre aqui!!!" rendered="#{empty agruparBean.iniciativasArrastradas}" style="font-size:24px;" />
            <p:dataTable id="IniciativasSeleccionadas" var="ini" value="#{agruparBean.iniciativasArrastradas}" rendered="#{not empty agruparBean.iniciativasArrastradas}">
                <p:column headerText="num">
                    <h:outputText value="#{ini.num}" />
                </p:column>
 
                <p:column headerText="descripcion">
                    <h:outputText value="#{ini.descripcion}" />
                </p:column>
 
                <p:column headerText="Usuario Proponente">
                    <h:outputText value="#{ini.usuarioproponente.nombre}" />
                </p:column>
 
                <p:column headerText="Fecha Registro">
                    <h:outputText value="#{ini.fechaRegistro}" />
                </p:column>
            </p:dataTable>
        </p:outputPanel>
    </p:fieldset>
 
    <p:droppable for="SeleccionIniciativas" tolerance="touch" activeStyleClass="ui-state-highlight" datasource="iniciativas" onDrop="handleDrop">
        <p:ajax listener="#{agruparBean.iniciativaArrastrada}" update="dropArea iniciativas" />
    </p:droppable>
</h:form>

    <p:commandButton update="iniciativasForm" action="#{agruparBean.inicializar()}" id="btnAgrupar" value="Agrupar" actionListener="#{agruparBean.agruparIniciativas(descripcion.value)}"/> 

    

  <br></br>
  <br></br>

  </body>
</html>
